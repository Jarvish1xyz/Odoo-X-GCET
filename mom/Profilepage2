import React, { useState } from 'react';
import 'bootstrap/dist/css/bootstrap.min.css';
import { 
  Camera, User, FileText, Phone, MapPin, 
  DollarSign, Shield, Lock, Download, Briefcase, 
  Plus, Calendar, Mail, Award
} from 'lucide-react';

const EmployeeProfile = ({ userRole = 'Employee' }) => {
  const isAdmin = userRole === 'Admin' || userRole === 'HR';
  const [activeTab, setActiveTab] = useState('Private Info');
  const [isEditing, setIsEditing] = useState(false);

  // Consolidated profile data with Resume and Security details
  
  const [profile, setProfile] = useState({
    name: "Jonathan Doe",
    jobPosition: "Senior Software Engineer",
    email: "j.doe@dayflow.com",
    mobile: "+1 (555) 012-3456",
    loginId: "jdoe_df_2024",
    company: "Dayflow HRMS",
    department: "Engineering",
    manager: "Sarah Jenkins",
    location: "New York Office",
    address: "789 Bluebell Way, Tech City, ST 54321",
    gender: "Male",
    maritalStatus: "Single",
    joiningDate: "2024-01-15",
    // Resume Data
    resume: {
      summary: "Full-stack developer with 6+ years of experience building scalable HR and Fintech solutions. Expert in React, Node.js, and Cloud Architecture.",
      experience: [
        { role: "Senior Dev", company: "TechCorp", years: "2021-2023" },
        { role: "Junior Dev", company: "WebFlow", years: "2018-2021" }
      ],
      education: "B.S. in Computer Science, Stanford University",
      skills: ["React", "JavaScript", "SQL", "AWS", "Docker"]
    },
    // Security Data
    security: {
      twoFactor: "Enabled",
      lastLogin: "Jan 03, 2026 - 09:15 AM",
      securityCode: "DF-9982-X"
    },
    salary: { basic: "₹25,000", hra: "₹12,500", net: "₹50,000" }
  });

  const handleInputChange = (e) => {
    const { name, value } = e.target;
    setProfile(prev => ({ ...prev, [name]: value }));
  };

  return (
    <div className="min-h-screen bg-[#f4f7f6] font-sans">
      {/* 1. TOP NAVIGATION (Exact Excalidraw Style) */}
      <nav className="navbar navbar-expand-lg navbar-dark bg-[#1a1d21] px-4 border-bottom border-primary border-3 shadow-sm">
        <span className="navbar-brand fw-bold text-info fs-4 tracking-tight">Dayflow</span>
        <div className="navbar-nav me-auto ms-4 gap-4">
          <a className="nav-link text-light opacity-75 small fw-medium" href="#">Employees</a>
          <a className="nav-link text-light opacity-75 small fw-medium" href="#">Attendance</a>
          <a className="nav-link text-light opacity-75 small fw-medium" href="#">Time Off</a>
        </div>
        <div className="ms-auto d-flex align-items-center gap-3">
           <div className="rounded-circle bg-danger border border-white border-2" style={{width: '28px', height: '28px'}}></div>
           <div className="rounded bg-primary border border-white border-2" style={{width: '28px', height: '28px'}}></div>
        </div>
      </nav>

      <div className="container py-4">
        {/* 2. PROFILE HEADER SECTION */}
        <div className="card shadow-sm border-0 mb-4 rounded-3 overflow-hidden">
          <div className="bg-[#e9ecef] px-4 py-2 border-bottom d-flex justify-content-between align-items-center">
            <span className="fw-bold text-muted small letter-spacing-1">MY PROFILE</span>
            <button 
              className={`btn btn-sm ${isEditing ? 'btn-success' : 'btn-primary'} px-4 rounded-pill fw-bold transition-all shadow-sm`}
              onClick={() => setIsEditing(!isEditing)}
            >
              {isEditing ? 'Save Changes' : 'Edit Profile'}
            </button>
          </div>
          
          <div className="card-body p-4">
            <div className="row align-items-center">
              {/* Profile Image with Camera Overlay (Requirement 3.3.2) */}
              <div className="col-auto text-center pe-4 border-end">
                <div className="position-relative d-inline-block">
                  <div className="rounded-circle bg-[#4a3131] d-flex align-items-center justify-content-center border border-4 border-white shadow" style={{width: '130px', height: '130px'}}>
                    <User size={60} className="text-white opacity-20" />
                  </div>
                  {isEditing && (
                    <label className="position-absolute bottom-0 end-0 bg-primary text-white p-2 rounded-circle shadow-sm border border-2 border-white cursor-pointer hover:scale-110 transition-transform">
                      <Camera size={16} />
                      <input type="file" className="d-none" />
                    </label>
                  )}
                </div>
              </div>

              {/* Main Information Blocks */}
              <div className="col border-end px-4">
                <h2 className="fw-bold text-[#2d3436] mb-3">{profile.name}</h2>
                <div className="row gy-2 small">
                  <div className="col-4 text-muted">Job Position</div>
                  <div className="col-8 fw-bold">{profile.jobPosition}</div>
                  <div className="col-4 text-muted">Email</div>
                  <div className="col-8 text-primary fw-medium">{profile.email}</div>
                  <div className="col-4 text-muted">Mobile</div>
                  <div className="col-8">
                    {isEditing ? (
                      <input name="mobile" className="form-control form-control-sm border-primary" value={profile.mobile} onChange={handleInputChange} />
                    ) : (<span className="fw-medium">{profile.mobile}</span>)}
                  </div>
                </div>
              </div>

              <div className="col ps-4">
                <div className="row gy-2 small">
                  <div className="col-5 text-muted">Department</div><div className="col-7 fw-medium">{profile.department}</div>
                  <div className="col-5 text-muted">Manager</div><div className="col-7 fw-medium">{profile.manager}</div>
                  <div className="col-5 text-muted">Location</div><div className="col-7 fw-medium">{profile.location}</div>
                </div>
              </div>
            </div>
          </div>

          {/* 3. TABS (As per Excalidraw) */}
          <div className="bg-light border-top">
            <ul className="nav nav-tabs border-0 px-3">
              {['Resume', 'Private Info', 'Salary Info', 'Security'].map(tab => (
                <li key={tab} className="nav-item">
                  <button 
                    className={`nav-link border-0 px-4 py-3 fw-bold transition-all ${activeTab === tab ? 'active bg-white text-dark border-start border-end shadow-none' : 'text-muted bg-transparent'}`}
                    onClick={() => setActiveTab(tab)}
                  >
                    {tab}
                  </button>
                </li>
              ))}
            </ul>
          </div>
        </div>

        {/* 4. TAB CONTENT AREA */}
        <div className="row g-4">
          {activeTab === 'Resume' && (
            <div className="col-12">
              <div className="card shadow-sm border-0 p-4 bg-white">
                <h6 className="fw-bold mb-4 border-bottom pb-2 d-flex align-items-center gap-2">
                  <FileText size={18} className="text-primary"/> Professional Background
                </h6>
                <div className="row">
                  <div className="col-md-8 border-end px-4">
                    <p className="text-muted mb-4">{profile.resume.summary}</p>
                    <h6 className="small fw-bold text-uppercase text-primary mb-3">Experience</h6>
                    {profile.resume.experience.map((exp, i) => (
                      <div key={i} className="mb-3 d-flex justify-content-between align-items-start border-start border-3 border-light ps-3">
                        <div>
                          <p className="mb-0 fw-bold">{exp.role}</p>
                          <p className="text-muted small mb-0">{exp.company}</p>
                        </div>
                        <span className="badge bg-light text-dark border">{exp.years}</span>
                      </div>
                    ))}
                  </div>
                  <div className="col-md-4 px-4">
                    <h6 className="small fw-bold text-uppercase text-primary mb-3">Skills</h6>
                    <div className="d-flex flex-wrap gap-2">
                      {profile.resume.skills.map(skill => (
                        <span key={skill} className="badge bg-primary bg-opacity-10 text-primary border border-primary border-opacity-10 px-3 py-2">{skill}</span>
                      ))}
                    </div>
                  </div>
                </div>
              </div>
            </div>
          )}

          {activeTab === 'Private Info' && (
            <div className="col-12">
              <div className="card shadow-sm border-0 p-4 bg-white">
                <div className="row">
                  <div className="col-md-6 border-end px-4">
                    <h6 className="fw-bold mb-4 border-bottom pb-2 d-flex align-items-center gap-2"><User size={18} className="text-primary"/> Personal Details</h6>
                    <div className="row gy-3 small">
                      <div className="col-5 text-muted">Residential Address</div>
                      <div className="col-7">
                        {isEditing ? (
                          <textarea name="address" className="form-control form-control-sm border-primary shadow-sm" rows="3" value={profile.address} onChange={handleInputChange} />
                        ) : (<p className="mb-0 fw-medium">{profile.address}</p>)}
                      </div>
                      <div className="col-5 text-muted">Gender</div><div className="col-7 fw-medium">{profile.gender}</div>
                      <div className="col-5 text-muted">Marital Status</div><div className="col-7 fw-medium">{profile.maritalStatus}</div>
                      <div className="col-5 text-muted fw-bold border-top pt-2">Date of Joining</div>
                      <div className="col-7 border-top pt-2 fw-bold text-success">{profile.joiningDate}</div>
                    </div>
                  </div>
                  <div className="col-md-6 px-4">
                     <h6 className="fw-bold mb-4 border-bottom pb-2 d-flex align-items-center gap-2"><Award size={18} className="text-primary"/> Education</h6>
                     <div className="p-3 bg-light rounded border border-dashed text-center">
                        <p className="mb-0 fw-bold small">{profile.resume.education}</p>
                     </div>
                  </div>
                </div>
              </div>
            </div>
          )}

          {activeTab === 'Salary Info' && (
            <div className="col-12">
              <div className="card shadow-sm border-0 p-4 bg-white">
                <div className="d-flex justify-content-between align-items-center mb-4 border-bottom pb-2">
                  <h5 className="fw-bold mb-0 text-primary"><DollarSign size={20}/> Salary Structure</h5>
                  <span className="badge bg-warning bg-opacity-10 text-warning border border-warning border-opacity-25 px-3 py-2"><Shield size={14} className="me-1"/> Read-Only for Employees</span>
                </div>
                <div className="row text-center g-4">
                  <div className="col-md-4"><div className="bg-light p-3 rounded-3 border"><div className="text-muted small">Basic</div><div className="h4 fw-bold">{profile.salary.basic}</div></div></div>
                  <div className="col-md-4"><div className="bg-light p-3 rounded-3 border"><div className="text-muted small">HRA</div><div className="h4 fw-bold">{profile.salary.hra}</div></div></div>
                  <div className="col-md-4"><div className="bg-primary bg-opacity-10 p-3 rounded-3 border border-primary border-opacity-25"><div className="text-primary small fw-bold">Net Salary</div><div className="h4 fw-bold text-primary">{profile.salary.net}</div></div></div>
                </div>
              </div>
            </div>
          )}

          {activeTab === 'Security' && (
            <div className="col-12">
              <div className="card shadow-sm border-0 p-4 bg-white">
                <h6 className="fw-bold mb-4 border-bottom pb-2 d-flex align-items-center gap-2"><Lock size={18} className="text-danger"/> Security & Access</h6>
                <div className="row gy-4">
                   <div className="col-md-4">
                      <div className="p-3 border rounded shadow-xs">
                        <label className="text-muted extra-small d-block mb-1">SECURITY CODE</label>
                        <span className="fw-mono fw-bold text-dark">{profile.security.securityCode}</span>
                      </div>
                   </div>
                   <div className="col-md-4">
                      <div className="p-3 border rounded">
                        <label className="text-muted extra-small d-block mb-1">2-FACTOR AUTH</label>
                        <span className="badge bg-success">{profile.security.twoFactor}</span>
                      </div>
                   </div>
                   <div className="col-md-4">
                      <div className="p-3 border rounded bg-light">
                        <label className="text-muted extra-small d-block mb-1">LAST LOGIN</label>
                        <span className="small text-muted">{profile.security.lastLogin}</span>
                      </div>
                   </div>
                </div>
              </div>
            </div>
          )}
        </div>
      </div>
    </div>
  );
};

export default EmployeeProfile;
